import pandas as pd
from datetime import date

def format_currency(value):
    """Format a numeric value as currency"""
    if pd.isna(value) or value == 0:
        return "£0.00"
    return f"£{value:,.2f}"

def apply_currency_formatting(df, columns):
    """Apply currency formatting to specified columns in a dataframe"""
    df_formatted = df.copy()
    for col in columns:
        if col in df_formatted.columns:
            df_formatted[col] = df_formatted[col].apply(format_currency)
    return df_formatted

def apply_currency_or_empty_formatting(df, columns):
    """Apply currency formatting but empty for zeros to specified columns"""
    df_formatted = df.copy()
    for col in columns:
        if col in df_formatted.columns:
            df_formatted[col] = df_formatted[col].apply(lambda x: f"£{x:,.2f}" if pd.notna(x) and x != 0 else "")
    return df_formatted

def create_site_header_row(columns, site_column_mapping):
    """Create site header row for calendar display"""
    site_header_row = {}
    for col in columns:
        if col in ["Date", "Day"]:
            site_header_row[col] = ""
        else:
            site_found = ""
            for site, site_columns in site_column_mapping.items():
                if col in site_columns:
                    site_found = site
                    break
            site_header_row[col] = site_found
    return site_header_row

def style_calendar_row(row, today_date):
    """Apply styling to calendar rows"""
    # Simplified styling - return basic styles
    return [''] * len(row)
